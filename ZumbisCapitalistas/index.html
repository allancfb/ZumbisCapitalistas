<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Zumbis Capitalistas</title>
    <script src="js/scripts.js"></script>
    <script>
        function novoJogo() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('novoJogo').style.display = 'block';
        }

        function novoJogoNome(nome) {
            gerenciador.setSaveGame(nome);
            document.getElementById('novoJogo').style.display = 'none';
            document.getElementById('menu').style.display = 'block';
        }
        
        function carregarJogo() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('carregarJogo').style.display = 'block';

            for (let i = 0; i < gerenciador.jogadores.length; i++) {
                let x = document.getElementById("select");
                x.remove(0);
            }

            for (jogador of gerenciador.jogadores) {
                let x = document.getElementById("select");
                let c = document.createElement("option");
                c.text = jogador.nome;
                x.options.add(c, 0);
            }
        }

        function carregarJogoNome(nome) {
            document.getElementById('carregarJogo').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            jogador = gerenciador.getSaveGame(nome);
            setInterval(atualizar,10)
        }

        function menu(div) {
            div.style.display = 'none';
            document.getElementById('menu').style.display = 'block';
        }

        function atualizar() {
            document.getElementById('qtdCerebros').innerText = jogador.cerebro.quantidade;
            document.getElementById('qtdCerebrosDourados').innerText = jogador.cerebroDourado.quantidade;
            document.getElementById('qtdPopulacao').innerText = jogador.populacao.quantidade;
        }

        function clicarPlaneta() {
            let cerebros = jogador.cerebrosPorClique;
            let tipo = definirTipo();
            aumentarQuantidadeCerebros(cerebros, tipo);
        }

        function definirTipo() {
            let prob = {0: 0.95, 1: 0.05}; // 0.05 de probabilidade de se obter um cérebro dourado
            rand = Math.random();
            soma = 0;
            
            for (i in prob) {
                soma += prob[i];
                if (rand <= soma) {
                    return i;
                }
            }
        }

        function aumentarQuantidadeCerebros(cerebros, tipo) {
            if (tipo == 0) {
                jogador.cerebro.incrementar(cerebros);
            } else {
                jogador.cerebroDourado.incrementar(cerebros);
            }

            jogador.populacao.decrementar(cerebros);
        }

    </script>
</head>
<body>
    <h1>Zumbis Capitalistas</h1>

    <div id="menu">
        <button onclick="novoJogo()">Novo Jogo</button>
        <button onclick="carregarJogo()">Carregar Jogo</button>
    </div>

    <div id="novoJogo" style="display: none;">
        <input type="text" id="nome">
        <button onclick="novoJogoNome(document.getElementById('nome').value)">Criar</button>
        <button onclick="menu(document.getElementById('novoJogo'))">Menu</button>
    </div>

    <div id="carregarJogo" style="display: none;">
        <select id="select"></select>
        <button onclick="carregarJogoNome(document.getElementById('select').options[document.getElementById('select').selectedIndex].value)">Começar</button>
        <button onclick="menu(document.getElementById('carregarJogo'))">Menu</button>
    </div>

    <div id="game" style="display: none;">
        <p><span> População do planeta: </span><span id="qtdPopulacao" style="display: inline;"></span></p>
        <p><span id="qtdCerebros" style="display: inline;"></span><span> Cérebros Comuns</span></p>
        <p><span id="qtdCerebrosDourados" style="display: inline;"></span><span> Cérebros Dourados</span></p>
        <button onclick="clicarPlaneta()">Planeta</button>
        <button onclick="menu(document.getElementById('game'))">Menu</button>
    </div>
</body>
</html>